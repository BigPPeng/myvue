{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nexport default {\n  data() {\n    return {\n      loginForm: {\n        userName: \"\",\n        userPass: \"\"\n      },\n      loginRules: {\n        userName: [{\n          required: true,\n          message: \"用户名是必填项\",\n          trigger: \"blur\"\n        },\n        //必填项\n        {\n          min: 5,\n          max: 12,\n          message: \"长度在 5 到 12个字符\",\n          trigger: \"blur\"\n        } //字符长度\n        ],\n        userPass: [{\n          required: true,\n          message: \"用户密码是必填项\",\n          trigger: \"blur\"\n        },\n        //必填项\n        {\n          min: 5,\n          max: 12,\n          message: \"长度在 5 ~ 12个字符\",\n          trigger: \"blur\"\n        } //字符长度\n        ]\n      },\n      // showRegisterView: false // 控制注册弹窗的显示与隐藏\n      dialogVisible: false,\n      registerForm: {\n        username: \"\",\n        password: \"\",\n        identity: \"\",\n        // 初始值可以是'farmer'、'supplier'或'buyer'中的任何一个，或者为空字符串\n        phone: \"\",\n        address: \"\"\n      }\n    };\n  },\n  methods: {\n    //重置方法\n    resetLoginForm() {\n      this.$refs.loginFormRef.resetFields();\n    },\n    //登录方法\n    login() {\n      //验证表单是否符合校验规则\n      this.$refs.loginFormRef.validate(async valid => {\n        //如果valid==true,表单符合校验规则,如果valid==false,表单不符合规则,退出方法\n        if (!valid) return;\n        //若表单符合规则,就去调用后台接口\n        const {\n          data: ref\n        } = await this.$http.post(\"/api/user/userLogin\", this.loginForm);\n        if (ref.status == 0) {\n          this.$message.success(\"登录成功\");\n          window.sessionStorage.setItem(\"flag\", \"ok\"); // session 放置\n          //将user存储到session域空间中\n          // console.log(ref);\n          // console.log(ref.data);\n          // console.log(ref.data.id);\n          let userObject = JSON.stringify(ref.data);\n          window.sessionStorage.setItem(\"user\", [userObject]);\n          //跳转到系统主页,通过路由实现\n          if (ref.data.userType === 1) {\n            // 农户\n            this.$router.push({\n              path: '/IndexView2'\n            });\n          } else if (ref.data.userType === 3) {\n            // 管理员\n            this.$router.push({\n              path: '/IndexView2'\n            });\n          } else {\n            // 管理员\n            this.$router.push({\n              path: '/IndexView'\n            });\n          }\n        } else {\n          this.$message.error(\"登录失败\");\n        }\n      });\n    },\n    submitForm(formName) {\n      this.$refs[formName].validate(valid => {\n        if (valid) {\n          alert(\"提交成功\"); // 这里应该是一个异步请求来提交表单数据到服务器\n        } else {\n          console.log(\"error submit!!\");\n          return false;\n        }\n      });\n    },\n    handleRegisterSuccess() {\n      // 处理注册成功的逻辑，比如跳转到登录页面或首页\n      this.$router.push(\"IndexView\"); // 假设注册成功后跳转到登录页面\n    }\n  }\n};","map":{"version":3,"names":["data","loginForm","userName","userPass","loginRules","required","message","trigger","min","max","dialogVisible","registerForm","username","password","identity","phone","address","methods","resetLoginForm","$refs","loginFormRef","resetFields","login","validate","valid","ref","$http","post","status","$message","success","window","sessionStorage","setItem","userObject","JSON","stringify","userType","$router","push","path","error","submitForm","formName","alert","console","log","handleRegisterSuccess"],"sources":["src/components/common/LoginView.vue"],"sourcesContent":["<template>\n  <div class=\"login_container\">\n    <!-- 登录模块 -->\n    <div class=\"login_box\">\n      <div class=\"movie-title\">\n        <span>现代农业服务平台</span>\n      </div>\n      <!--表单-->\n      <el-form ref=\"loginFormRef\" :model=\"loginForm\" :rules=\"loginRules\" class=\"login_form\" label-width=\"0\">\n        <el-form-item prop=\"username\">\n          <el-input v-model=\"loginForm.userName\" prefix-icon=\"el-icon-user\" placeholder=\"请输入用户名\"></el-input>\n        </el-form-item>\n        <el-form-item prop=\"password\">\n          <el-input v-model=\"loginForm.userPass\" prefix-icon=\"el-icon-lock\" type=\"password\"\n            placeholder=\"请输入密码\"></el-input>\n        </el-form-item>\n        <!-- 新用户注册按钮 -->\n        <!-- <el-button type=\"primary\" @click=\"showRegisterDialog = true\">新用户注册</el-button>\n        -->\n        <!-- <el-button type=\"text\" @click=\"open\">新用户注册</el-button>-->\n        <el-button type=\"text\" @click=\"dialogVisible = true\">新用户注册</el-button>\n\n        <el-form-item class=\"bts\">\n          <el-button type=\"primary\" @click=\"login()\">登录</el-button>\n          <el-button type=\"info\" @click=\"resetLoginForm()\">重置</el-button>\n        </el-form-item>\n      </el-form>\n    </div>\n    <!-- 对话框 -->\n    <el-dialog title=\"注册\" :visible.sync=\"dialogVisible\" width=\"50%\" @close=\"dialogVisible = false\">\n      <el-form :model=\"registerForm\" ref=\"registerForm\" label-width=\"120px\">\n        <el-form-item label=\"用户名\">\n          <el-input v-model=\"registerForm.username\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"密码\">\n          <el-input type=\"password\" v-model=\"registerForm.password\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"身份\">\n          <el-radio-group v-model=\"registerForm.identity\">\n            <el-radio label=\"farmer\">农户</el-radio>\n            <el-radio label=\"supplier\">供货商</el-radio>\n            <el-radio label=\"buyer\">收购商</el-radio>\n          </el-radio-group>\n        </el-form-item>\n        <el-form-item label=\"手机号码\">\n          <el-input v-model=\"registerForm.phone\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"地址\">\n          <el-input v-model=\"registerForm.address\"></el-input>\n        </el-form-item>\n        <el-form-item>\n          <el-button type=\"primary\" @click=\"submitForm('registerForm')\">提交</el-button>\n          <el-button @click=\"dialogVisible = false\">取消</el-button>\n        </el-form-item>\n      </el-form>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nexport default {\n  data() {\n    return {\n      loginForm: {\n        userName: \"\",\n        userPass: \"\",\n      },\n      loginRules: {\n        userName: [\n          { required: true, message: \"用户名是必填项\", trigger: \"blur\" }, //必填项\n          { min: 5, max: 12, message: \"长度在 5 到 12个字符\", trigger: \"blur\" }, //字符长度\n        ],\n        userPass: [\n          { required: true, message: \"用户密码是必填项\", trigger: \"blur\" }, //必填项\n          { min: 5, max: 12, message: \"长度在 5 ~ 12个字符\", trigger: \"blur\" }, //字符长度\n        ],\n      },\n      // showRegisterView: false // 控制注册弹窗的显示与隐藏\n      dialogVisible: false,\n      registerForm: {\n        username: \"\",\n        password: \"\",\n        identity: \"\", // 初始值可以是'farmer'、'supplier'或'buyer'中的任何一个，或者为空字符串\n        phone: \"\",\n        address: \"\",\n      },\n    };\n  },\n\n  methods: {\n    //重置方法\n    resetLoginForm() {\n      this.$refs.loginFormRef.resetFields();\n    },\n    //登录方法\n    login() {\n      //验证表单是否符合校验规则\n      this.$refs.loginFormRef.validate(async (valid) => {\n        //如果valid==true,表单符合校验规则,如果valid==false,表单不符合规则,退出方法\n        if (!valid) return;\n        //若表单符合规则,就去调用后台接口\n        const { data: ref } = await this.$http.post(\n          \"/api/user/userLogin\",\n          this.loginForm\n        );\n        if (ref.status == 0) {\n          this.$message.success(\"登录成功\");\n          window.sessionStorage.setItem(\"flag\", \"ok\"); // session 放置\n          //将user存储到session域空间中\n          // console.log(ref);\n          // console.log(ref.data);\n          // console.log(ref.data.id);\n          let userObject = JSON.stringify(ref.data);\n          window.sessionStorage.setItem(\"user\", [userObject]);\n          //跳转到系统主页,通过路由实现\n          if(ref.data.userType === 1) {// 农户\n            this.$router.push({ path: '/IndexView2' });\n          } else if(ref.data.userType === 3) {// 管理员\n            this.$router.push({ path: '/IndexView2' });\n          } else {// 管理员\n            this.$router.push({ path: '/IndexView' });\n          }\n        } else {\n          this.$message.error(\"登录失败\");\n        }\n      });\n    },\n\n    submitForm(formName) {\n      this.$refs[formName].validate((valid) => {\n        if (valid) {\n          alert(\"提交成功\"); // 这里应该是一个异步请求来提交表单数据到服务器\n        } else {\n          console.log(\"error submit!!\");\n          return false;\n        }\n      });\n    },\n\n    handleRegisterSuccess() {\n      // 处理注册成功的逻辑，比如跳转到登录页面或首页\n      this.$router.push(\"IndexView\"); // 假设注册成功后跳转到登录页面\n    },\n  },\n};\n</script>\n\n<style lang=\"less\" scoped>\n//根节点样式\n.login_container {\n  background-color: #2b4b6b;\n  background-image: url(../../assets/26811716173483_.pic.jpg);\n  background-size: 100%;\n  background-repeat: no-repeat;\n  height: 100%;\n  width: 100%;\n  min-height: 100vh;\n}\n\n//登录盒子样式\n.login_box {\n  width: 450px;\n  height: 250px;\n  background-color: gainsboro;\n  border-radius: 3px;\n  position: absolute;\n  left: 50%;\n  top: 50%;\n  transform: translate(-50%, -50%);\n  text-align: center;\n  opacity: 0.9;\n\n  .movie-title {\n    font-size: 50px;\n    margin-top: -60px;\n    margin-left: 0px;\n  }\n\n  /*.avatar_box{*/\n  /*   width: 130px;*/\n  /*   height: 130px;*/\n  /*   border: 1px solid #eee;*/\n  /*   border-radius: 50%;*/\n  /*   padding: 5px;*/\n  /*   //盒子阴影*/\n  /*   box-shadow: 0 0 2px #ddd;*/\n  /*   position: absolute;*/\n  /*   left: 50%;*/\n  /*   transform: translate(-50%,-50%);*/\n  /*   background-color: #0ee;*/\n  /*   //LoGo样式*/\n  /*   img{*/\n  /*     width: 100%;*/\n  /*     height: 100%;*/\n  /*     background-color: #eee;*/\n  /*     border-radius: 50%;*/\n  /*   }*/\n  /* }*/\n}\n\n//表单样式\n.bts {\n  display: flex;\n  //弹性盒子元素将向行结束位置对齐\n  justify-content: flex-end;\n}\n\n.login_form {\n  position: absolute;\n  bottom: 0;\n  width: 100%;\n  padding: 0 10px;\n\n  /**\n    border-box 告诉浏览器去理解你设置的边框和内边距的值是包含在width内的。\n    也就是说，如果你将一个元素的width设为100px,\n    那么这100px会包含其它的border和padding，内容区的实际宽度会是width减去border + padding的计算值。\n    大多数情况下这使得我们更容易的去设定一个元素的宽高。\n     */\n  box-sizing: border-box;\n}\n</style>\n"],"mappings":";AA4DA;EACAA,KAAA;IACA;MACAC,SAAA;QACAC,QAAA;QACAC,QAAA;MACA;MACAC,UAAA;QACAF,QAAA,GACA;UAAAG,QAAA;UAAAC,OAAA;UAAAC,OAAA;QAAA;QAAA;QACA;UAAAC,GAAA;UAAAC,GAAA;UAAAH,OAAA;UAAAC,OAAA;QAAA;QAAA,CACA;QACAJ,QAAA,GACA;UAAAE,QAAA;UAAAC,OAAA;UAAAC,OAAA;QAAA;QAAA;QACA;UAAAC,GAAA;UAAAC,GAAA;UAAAH,OAAA;UAAAC,OAAA;QAAA;QAAA;MAEA;MACA;MACAG,aAAA;MACAC,YAAA;QACAC,QAAA;QACAC,QAAA;QACAC,QAAA;QAAA;QACAC,KAAA;QACAC,OAAA;MACA;IACA;EACA;EAEAC,OAAA;IACA;IACAC,eAAA;MACA,KAAAC,KAAA,CAAAC,YAAA,CAAAC,WAAA;IACA;IACA;IACAC,MAAA;MACA;MACA,KAAAH,KAAA,CAAAC,YAAA,CAAAG,QAAA,OAAAC,KAAA;QACA;QACA,KAAAA,KAAA;QACA;QACA;UAAAxB,IAAA,EAAAyB;QAAA,eAAAC,KAAA,CAAAC,IAAA,CACA,uBACA,KAAA1B,SACA;QACA,IAAAwB,GAAA,CAAAG,MAAA;UACA,KAAAC,QAAA,CAAAC,OAAA;UACAC,MAAA,CAAAC,cAAA,CAAAC,OAAA;UACA;UACA;UACA;UACA;UACA,IAAAC,UAAA,GAAAC,IAAA,CAAAC,SAAA,CAAAX,GAAA,CAAAzB,IAAA;UACA+B,MAAA,CAAAC,cAAA,CAAAC,OAAA,UAAAC,UAAA;UACA;UACA,IAAAT,GAAA,CAAAzB,IAAA,CAAAqC,QAAA;YAAA;YACA,KAAAC,OAAA,CAAAC,IAAA;cAAAC,IAAA;YAAA;UACA,WAAAf,GAAA,CAAAzB,IAAA,CAAAqC,QAAA;YAAA;YACA,KAAAC,OAAA,CAAAC,IAAA;cAAAC,IAAA;YAAA;UACA;YAAA;YACA,KAAAF,OAAA,CAAAC,IAAA;cAAAC,IAAA;YAAA;UACA;QACA;UACA,KAAAX,QAAA,CAAAY,KAAA;QACA;MACA;IACA;IAEAC,WAAAC,QAAA;MACA,KAAAxB,KAAA,CAAAwB,QAAA,EAAApB,QAAA,CAAAC,KAAA;QACA,IAAAA,KAAA;UACAoB,KAAA;QACA;UACAC,OAAA,CAAAC,GAAA;UACA;QACA;MACA;IACA;IAEAC,sBAAA;MACA;MACA,KAAAT,OAAA,CAAAC,IAAA;IACA;EACA;AACA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}