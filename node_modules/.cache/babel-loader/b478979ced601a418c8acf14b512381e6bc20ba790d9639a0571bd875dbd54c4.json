{"ast":null,"code":"export default {\n  created() {\n    this.getList();\n  },\n  data() {\n    return {\n      tableData: [],\n      dialogVisible: false,\n      publishRecr: {\n        recruitmentUserId: \"\",\n        title: \"\",\n        jobDescription: \"\",\n        recruitmentTime: \"\",\n        recruitmentQuantity: \"\"\n      }\n    };\n  },\n  methods: {\n    gotoPublish() {\n      let user = window.sessionStorage.getItem('user');\n      let userObj = JSON.parse(user);\n      this.publishRecr.recruitmentUserId = userObj.id;\n      this.dialogVisible = true;\n    },\n    async submitForm() {\n      const {\n        data: aa\n      } = await this.$http.post(\"/api/recruitment/publishRecruitmentInfo\", this.publishRecr);\n      // status ==0 表示成功，成功后要关闭弹窗，并且清空弹窗中的内容\n      if (aa.status === 0) {\n        this.publishRecr.recruitmentUserId = \"\";\n        this.publishRecr.title = \"\";\n        this.publishRecr.jobDescription = \"\";\n        this.publishRecr.recruitmentTime = \"\";\n        this.publishRecr.recruitmentQuantity = \"\";\n        this.dialogVisible = false;\n        this.$message.success(\"发布成功\");\n        this.getList();\n      } else {\n        this.$message.fail(\"发布失败\" + aa.message);\n      }\n    },\n    async getList() {\n      let user = window.sessionStorage.getItem('user');\n      let userObj = JSON.parse(user);\n      const {\n        data: aa\n      } = await this.$http.post(\"/api/recruitment/selectRecruitmentInfoByRecruitmentUserId\", {\n        id: userObj.id\n      });\n      console.log(aa);\n      this.tableData = aa.data;\n    },\n    //删除\n    async deleteUser(row) {\n      console.log(row);\n      const userName = row.username;\n      const confirmResult = await this.$confirm('是否确认删除名称为\"' + userName + '\"的用户?', \"提示\", {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).catch(err => err);\n      // 成功删除为confirm 取消为 cancel\n      if (confirmResult != 'confirm') {\n        this.$refs.multipleTable.clearSelection();\n        return this.$message.info(\"已取消删除\");\n      }\n      const {\n        data: bb\n      } = await this.$http.post(\"/api/user/deleteUser\", {\n        id: row.id\n      });\n      this.$message.success(bb);\n      this.getList();\n    }\n  }\n};","map":{"version":3,"names":["created","getList","data","tableData","dialogVisible","publishRecr","recruitmentUserId","title","jobDescription","recruitmentTime","recruitmentQuantity","methods","gotoPublish","user","window","sessionStorage","getItem","userObj","JSON","parse","id","submitForm","aa","$http","post","status","$message","success","fail","message","console","log","deleteUser","row","userName","username","confirmResult","$confirm","confirmButtonText","cancelButtonText","type","catch","err","$refs","multipleTable","clearSelection","info","bb"],"sources":["src/components/pages/employ/EmployNews.vue"],"sourcesContent":["<template>\n  <div>\n    <h3 style=\"margin-top: 0\">发布雇用信息</h3>\n    <el-breadcrumb separator-class=\"el-icon-arrow-right\">\n      <el-breadcrumb-item :to=\"{ path: '/home' }\">首页</el-breadcrumb-item>\n      <el-breadcrumb-item>雇用农工</el-breadcrumb-item>\n      <el-breadcrumb-item>发布雇用信息</el-breadcrumb-item>\n    </el-breadcrumb>\n    <el-card>\n      <el-row :gutter=\"25\">\n        <el-col :span=\"5\">\n          <el-button type=\"primary\" @click=\"gotoPublish()\"\n            >发布雇用信息</el-button\n          >\n        </el-col>\n      </el-row>\n\n      <el-table\n        :data=\"tableData\"\n        border\n        style=\"width: 100%\"\n        typle=\"margin-top: 90px;\"\n      >\n        <el-table-column label=\"id\" prop=\"id\" />\n        <el-table-column label=\"雇用标题\" prop=\"recruitmentTitle\" />\n        <el-table-column label=\"雇用时间\" prop=\"recruitmentTime\" />\n        <el-table-column label=\"数量\" prop=\"recruitmentQuantity\" />\n        <el-table-column label=\"工作描述\" prop=\"jobDescription\" />\n        <el-table-column label=\"发布人\" prop=\"recruiterUserId\" v-if=\"false\"/>\n        <el-table-column label=\"发布时间\" prop=\"publishTime\" />\n        <el-table-column label=\"操作\">\n          <template slot-scope=\"scope\">\n            <!-- 修改 -->\n            <el-button\n              type=\"primary\"\n              icon=\"el-icon-edit\"\n              size=\"mini\"\n              @click=\"edit(scope.row)\"\n              >修改</el-button\n            >\n            <!-- 删除 -->\n            <el-button\n              type=\"danger\"\n              icon=\"el-icon-delete\"\n              size=\"mini\"\n              @click=\"handleDelete(scope.row)\"\n              >删除</el-button\n            >\n          </template>\n        </el-table-column>\n      </el-table>\n      <!-- 对话框 -->\n      <el-dialog\n        title=\"发布雇用信息\"\n        :visible.sync=\"dialogVisible\"\n        width=\"50%\"\n        @close=\"dialogVisible = false\"\n      >\n        <el-form :model=\"publishRecr\" ref=\"registerForm\" label-width=\"120px\">\n          <el-input placeholder=\"请输入标题\" v-model=\"publishRecr.recruitmentUserId\" v-show=\"false\"></el-input>\n          <el-form-item label=\"标题\">\n            <el-input placeholder=\"请输入标题\" v-model=\"publishRecr.title\"></el-input>\n          </el-form-item>\n          <el-form-item label=\"数量\">\n            <el-input placeholder=\"数量\" v-model=\"publishRecr.recruitmentQuantity\"></el-input>\n          </el-form-item>\n          <el-form-item label=\"时间\">\n            <el-input placeholder=\"时间\" v-model=\"publishRecr.recruitmentTime\"></el-input>\n          </el-form-item>\n          <el-form-item label=\"内容\">\n            <el-input\n              type=\"textarea\"\n              :rows=\"2\"\n              placeholder=\"请输入内容\"\n              v-model=\"publishRecr.jobDescription\"\n            ></el-input>\n          </el-form-item>\n          <el-form-item>\n            <el-button type=\"primary\" @click=\"submitForm()\"\n              >发布</el-button\n            >\n            <el-button @click=\"dialogVisible = false\">取消</el-button>\n          </el-form-item>\n        </el-form>\n      </el-dialog>\n      <div>\n        <el-pagination></el-pagination>\n      </div>\n    </el-card>\n  </div>\n</template>\n\n<script>\nexport default {\n  created() {\n    this.getList();\n  },\n  data() {\n    return {\n      tableData: [],\n      dialogVisible: false,\n      publishRecr: {\n        recruitmentUserId: \"\",\n        title: \"\",\n        jobDescription: \"\", \n        recruitmentTime: \"\",\n        recruitmentQuantity: \"\",\n      },\n    };\n  },\n  methods: {\n    gotoPublish(){\n      let user = window.sessionStorage.getItem('user');\n      let userObj = JSON.parse(user);\n      this.publishRecr.recruitmentUserId = userObj.id;\n      this.dialogVisible =true;\n    },\n    async submitForm() {\n      const { data: aa } = await this.$http.post(\"/api/recruitment/publishRecruitmentInfo\", this.publishRecr);\n      // status ==0 表示成功，成功后要关闭弹窗，并且清空弹窗中的内容\n      if (aa.status === 0) {\n        this.publishRecr.recruitmentUserId = \"\";\n        this.publishRecr.title = \"\";\n        this.publishRecr.jobDescription = \"\";\n        this.publishRecr.recruitmentTime = \"\";\n        this.publishRecr.recruitmentQuantity = \"\";\n        this.dialogVisible =false;\n        this.$message.success(\"发布成功\");\n        this.getList();\n      } else{\n        this.$message.fail(\"发布失败\"+aa.message);\n      }\n    },\n    async getList() {\n      let user = window.sessionStorage.getItem('user');\n      let userObj = JSON.parse(user);\n      const { data: aa } = await this.$http.post(\"/api/recruitment/selectRecruitmentInfoByRecruitmentUserId\", {id:userObj.id});\n      console.log(aa)\n      this.tableData = aa.data;\n    },\n    \n    //删除\n    async deleteUser(row) {\n      console.log(row)\n      const userName = row.username;\n      const confirmResult = await this.$confirm('是否确认删除名称为\"' + userName + '\"的用户?', \"提示\", {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).catch(err => err)\n      // 成功删除为confirm 取消为 cancel\n      if (confirmResult != 'confirm') {\n        this.$refs.multipleTable.clearSelection();\n        return this.$message.info(\"已取消删除\");\n      }\n      const { data: bb } = await this.$http.post(\"/api/user/deleteUser\", { id: row.id });\n      this.$message.success(bb);\n      this.getList();\n    }, \n    \n  },\n};\n</script>\n\n<style lang=\"less\" scoped>\n.el-breadcrumb {\n  margin-bottom: 15px;\n  font-size: 17px;\n}\n</style>\n"],"mappings":"AA6FA;EACAA,QAAA;IACA,KAAAC,OAAA;EACA;EACAC,KAAA;IACA;MACAC,SAAA;MACAC,aAAA;MACAC,WAAA;QACAC,iBAAA;QACAC,KAAA;QACAC,cAAA;QACAC,eAAA;QACAC,mBAAA;MACA;IACA;EACA;EACAC,OAAA;IACAC,YAAA;MACA,IAAAC,IAAA,GAAAC,MAAA,CAAAC,cAAA,CAAAC,OAAA;MACA,IAAAC,OAAA,GAAAC,IAAA,CAAAC,KAAA,CAAAN,IAAA;MACA,KAAAR,WAAA,CAAAC,iBAAA,GAAAW,OAAA,CAAAG,EAAA;MACA,KAAAhB,aAAA;IACA;IACA,MAAAiB,WAAA;MACA;QAAAnB,IAAA,EAAAoB;MAAA,eAAAC,KAAA,CAAAC,IAAA,iDAAAnB,WAAA;MACA;MACA,IAAAiB,EAAA,CAAAG,MAAA;QACA,KAAApB,WAAA,CAAAC,iBAAA;QACA,KAAAD,WAAA,CAAAE,KAAA;QACA,KAAAF,WAAA,CAAAG,cAAA;QACA,KAAAH,WAAA,CAAAI,eAAA;QACA,KAAAJ,WAAA,CAAAK,mBAAA;QACA,KAAAN,aAAA;QACA,KAAAsB,QAAA,CAAAC,OAAA;QACA,KAAA1B,OAAA;MACA;QACA,KAAAyB,QAAA,CAAAE,IAAA,UAAAN,EAAA,CAAAO,OAAA;MACA;IACA;IACA,MAAA5B,QAAA;MACA,IAAAY,IAAA,GAAAC,MAAA,CAAAC,cAAA,CAAAC,OAAA;MACA,IAAAC,OAAA,GAAAC,IAAA,CAAAC,KAAA,CAAAN,IAAA;MACA;QAAAX,IAAA,EAAAoB;MAAA,eAAAC,KAAA,CAAAC,IAAA;QAAAJ,EAAA,EAAAH,OAAA,CAAAG;MAAA;MACAU,OAAA,CAAAC,GAAA,CAAAT,EAAA;MACA,KAAAnB,SAAA,GAAAmB,EAAA,CAAApB,IAAA;IACA;IAEA;IACA,MAAA8B,WAAAC,GAAA;MACAH,OAAA,CAAAC,GAAA,CAAAE,GAAA;MACA,MAAAC,QAAA,GAAAD,GAAA,CAAAE,QAAA;MACA,MAAAC,aAAA,cAAAC,QAAA,gBAAAH,QAAA;QACAI,iBAAA;QACAC,gBAAA;QACAC,IAAA;MACA,GAAAC,KAAA,CAAAC,GAAA,IAAAA,GAAA;MACA;MACA,IAAAN,aAAA;QACA,KAAAO,KAAA,CAAAC,aAAA,CAAAC,cAAA;QACA,YAAAnB,QAAA,CAAAoB,IAAA;MACA;MACA;QAAA5C,IAAA,EAAA6C;MAAA,eAAAxB,KAAA,CAAAC,IAAA;QAAAJ,EAAA,EAAAa,GAAA,CAAAb;MAAA;MACA,KAAAM,QAAA,CAAAC,OAAA,CAAAoB,EAAA;MACA,KAAA9C,OAAA;IACA;EAEA;AACA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}